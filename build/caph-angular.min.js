/* {{BUILD_STAMP}} */

/**
 * Copyright (c) 2014 Samsung Electronics Co., Ltd All Rights Reserved 
 * PROPRIETARY/CONFIDENTIAL
 *  
 * This software is the confidential and proprietary information of SAMSUNG 
 * ELECTRONICS ("Confidential Information"). You shall not disclose such 
 * Confidential Information and shall use it only in accordance with the terms of 
 * the license agreement you entered into with SAMSUNG ELECTRONICS. SAMSUNG make 
 * no representations or warranties about the suitability of the software, either 
 * express or implied, including but not limited to the implied warranties of 
 * merchantability, fitness for a particular purpose, or non-infringement. 
 * SAMSUNG shall not be liable for any damages suffered by licensee as a result 
 * of using, modifying or distributing this software or its derivatives.
 */

"use strict";function FocusControllerProvider(e){function t(e,t){return angular.isFunction(t)?(e.push(t),!0):!1}function n(e,t){var n=e.indexOf(t);return n>-1?(e.splice(n,1),!0):!1}function o(e,n){return t(h,e)?(e.order=n||0,h.sort(i),!0):!1}function i(e,t){return e.order-t.order}function r(e){return t(m,e)}function a(e){return n(h,e)}function u(e){return n(m,e)}function s(){return angular.copy(p)}var c=".focus-controller",l="group:",d=e.DEFAULT.DEPTH,f={},p=e.DEFAULT.KEY_MAP,h=[],m=[],g=!1;f[e.DEFAULT.DEPTH]=e.DEFAULT.GROUP,this.setInitialDepth=function(e){return d=e,this},this.setInitialGroupOfDepth=function(t,n){var o={};return void 0===n&&(n=t,t=e.DEFAULT.DEPTH),angular.isObject(n)?o=n:o[t]=n,angular.extend(f,o),this},this.setKeyMap=function(e){return angular.extend(p,e),this},this.getKeyMap=s,this.addBeforeKeydownHandler=o,this.addAfterKeydownHandler=r,this.removeBeforeKeydownHandler=a,this.removeAfterKeydownHandler=u,this.setFocusWhenDisabled=function(e){return g=e,this},this.isFocusWhenDisabled=function(){return g},this.$get=["$rootScope","$window","$document","$timeout","$animate","FocusUtil","nearestFocusableFinder",function(t,n,i,v,b,C,I){function D(e){var t,n,o,i;if(S){if(n=C.getData(S).nextFocus[e],void 0===n)return I.getNearest(S,e);if(n){if(0===n.indexOf(l))return n.replace(l,"");if(o=I.$$get(n),C.isVisible(o)&&(i=C.getData(o),(!i.disabled||g)&&C.getData(S).depth===i.depth))return o}return null}return t=T(k),t?t:w()}function w(e,t){return T(M,e,t)||I.getInitial(F(e),A(t))}function $(e,t){var n;C.isFocusable(e=C.getElement(e))&&(n=C.getData(e),n.depth===N&&(y(e,"blurred",[t]),e===S&&(L(k,e),S=null)))}function x(e,t){var n;C.isFocusable(e=C.getElement(e))&&e!==S&&(n=C.getData(e),n.depth!==N||n.disabled&&!g||(S&&$(S,t),y(e,"focused",[t]),R=n.group,S=e))}function E(e,t){C.isFocusable(e=C.getElement(e))&&C.isVisible(e)?e!==S||C.getData(e).disabled?x(e,t):y(e,"selected",[t]):(e=T(k),e?x(e,t):x(e=w(),t))}function y(e,t,n){e&&jQuery(e).trigger(t,n)}function L(e,t,n,o){n=F(n),o=A(o),e[n]=e[n]||{},e[n][o]=t}function T(e,t,n){var o;return t=F(t),n=A(n),!C.isVisible(o=e[t]&&e[t][n])||C.getData(o).disabled&&!g?null:o}function F(e){return void 0===e?N:e}function A(e){return void 0===e?R:e}function P(e){return e?angular.isString(e)?I.$$get(e):e:S}function O(e,t,n){var o;C.isFocusable(e=C.getElement(e))&&(o=C.getData(e),o.disabled!==t&&(o.disabled=t,C.setData(e,o),n&&n(e)))}var S,N=d,R=f[d]||e.DEFAULT.GROUP,M={},k={},U={getCurrentDepth:function(){return N},getCurrentGroup:function(){return R},getCurrentFocusItem:function(){return S},setDepth:function(t,n,o){var i,r;return angular.isNumber(t)&&N!==t&&(i=o===!1?w(t,r=f[t]||e.DEFAULT.GROUP):T(k,t,r=n||f[t]||e.DEFAULT.GROUP)||w(t,r),i&&($(S),N=t,R=r,x(i))),this},setGroup:function(e){var t;return e&&R!==e&&(t=T(k,N,e)||w(N,e))&&($(S),R=e,x(t)),this},focus:function(e,t){return x(P(e),t),this},blur:function(e,t){return $(P(e),t),this},select:function(e,t){return E(P(e),t),this},enable:function(e){return O(P(e),!1,function(e){b.removeClass(e,"disabled")}),this},disable:function(e){return O(P(e),!0,function(e){e===S&&$(S,jQuery.Event("disabled")),b.addClass(e,"disabled")}),this},addBeforeKeydownHandler:o,addAfterKeydownHandler:r,removeBeforeKeydownHandler:a,removeAfterKeydownHandler:u,getKeyMap:s,$$getNextFocusItem:D,$$getInitialFocusItem:w,$$setInitialFocusItem:function(e){var t;return C.isFocusable(e=C.getElement(e))&&(t=C.getData(e),t.initialFocus&&L(M,e,t.depth,t.group)),this}};return jQuery(n).on("load",function(e){v(function(){x(T(M),e)})}),i.on("keydown"+c,function(n){var o,i=n.keyCode||n.which||n.charCode;if(h.some(function(e){return e({event:n,previousFocusedItem:T(k),currentFocusItem:S},U)===!1}))return t.$applyAsync(),void 0;switch(i){case p.LEFT:o=D(e.DIRECTION.LEFT);break;case p.RIGHT:o=D(e.DIRECTION.RIGHT);break;case p.UP:o=D(e.DIRECTION.UP);break;case p.DOWN:o=D(e.DIRECTION.DOWN);break;case p.ENTER:E(S,n)}o&&(angular.isString(o)?U.setGroup(o):($(S,n),x(o,n))),m.forEach(function(e){e({event:n,previousFocusedItem:T(k),currentFocusItem:S},U)}),t.$applyAsync()}),t.$on("$destroy",function(){i.off(c)}),U}]}function NearestFocusableFinderProvider(e,t){function n(e){var t=jQuery(e),n=t.offset();return{left:n.left,top:n.top,width:t.width(),height:t.height()}}var o={},i=[],r=e.DEFAULT.DISTANCE_CALCULATION_STRATEGY;o[e.DEFAULT.DISTANCE_CALCULATION_STRATEGY]=function(){function t(t,n){var o={x:t.left,y:t.top};switch(n){case e.DIRECTION.RIGHT:o.x+=t.width;case e.DIRECTION.LEFT:o.y+=t.height/2;break;case e.DIRECTION.DOWN:o.y+=t.height;case e.DIRECTION.UP:o.x+=t.width/2}return o}function n(t,n,o){switch(o){case e.DIRECTION.LEFT:return t.x>=n.x;case e.DIRECTION.RIGHT:return t.x<=n.x;case e.DIRECTION.UP:return t.y>=n.y;case e.DIRECTION.DOWN:return t.y<=n.y}return!1}var o={left:"right",right:"left",up:"down",down:"up"};return function(e,i,r){var a=t(e,r),u=t(i,o[r]);return n(a,u,r)?Math.sqrt(Math.pow(a.x-u.x,2)+Math.pow(a.y-u.y,2)):1/0}}(),this.registerDistanceCalculationStrategy=function(e,t,n){if(n===!1&&angular.isFunction(o[e]))throw Error('The given name "'+e+'" is already registered. If you want to override it, please do not pass the third parameter.');return o[e]=t,this},this.useDistanceCalculationStrategy=function(t){return t?angular.isFunction(o[t])?r=t:console.warn('The given name "'+t+'" is not registered yet. Using "'+r+'" instead.'):r=e.DEFAULT.DISTANCE_CALCULATION_STRATEGY,this},this.getRegisteredDistanceCalculationStrategies=function(){return Object.keys(o)},this.getCurrentDistanceCalculationStrategy=function(){return r},this.addBeforeDistanceCalculationHandler=function(e){return angular.isFunction(e)?(i.push(e),!0):!1},this.removeBeforeDistanceCalculationHandler=function(e){var t=i.indexOf(e);return t>-1?(i.splice(t,1),!0):!1},this.$get=["$rootScope","$document","FocusUtil",function(a,u,s){var c,l=Array.prototype.slice,d={},f={getInitial:function(n,o){var i;return n=n||e.DEFAULT.DEPTH,o=o||e.DEFAULT.GROUP,Object.keys(d).some(function(e){var r=d[e],a=s.getData(r);return!s.isVisible(r)||a.disabled&&!t.isFocusWhenDisabled()||a.depth!==n||a.group!==o?void 0:(i=r,!0)}),i},getNearest:function(e,a){var u,c,l,f,p,h=1/0;return s.isFocusable(e=s.getElement(e))&&(p=s.getData(e))&&(l=n(e),Object.keys(d).forEach(function(m){var g=d[m],v=s.getData(g);if(g!==e&&s.isVisible(g)&&(!v.disabled||t.isFocusWhenDisabled())&&p.depth===v.depth){if(i.some(function(e){return e(g)===!1}))return;f=n(g),u=o[r](l,f,a),h>u&&(c=g,h=u)}})),c},$$put:function(e,t){var n;return s.isFocusable(e=s.getElement(e))&&(n=s.setData(e,t))&&(d[n]=s.getElement(e)),this},$$get:function(e){return d[e]},$$remove:function(e){var t,n;return angular.isString(e)||(e=s.getData(e)),e&&(t=e.name,n=d[t],n&&delete d[t]),n}};return window.MutationObserver&&(c=new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&l.call(e.removedNodes).forEach(function(e){s.isElement(e)&&s.isFocusable(e)&&s.unbindEvent(f.$$remove(e))})})}),c.observe(u[0],{childList:!0,subtree:!0}),a.$on("$destroy",function(){c.disconnect()})),f}]}function ListItemLoaderProvider(e){function t(e){this.url=e.url,this.method=e.method||"JSONP",this.headers=e.headers,this.parameterNames=angular.extend({},i,e.parameterNames||{}),this.loadingCount=e.loadingCount,this.thresholdCount=e.thresholdCount,this.onGetTotalCount=e.getTotalCount||angular.noop,this.onGetItems=e.getItems||angular.identity,this.onBeforeLoad=e.onBeforeLoad||angular.noop,this.onAfterLoad=e.onAfterLoad||angular.noop,this.items=[],this.totalCount,this.loading=!1,this.offset=0,this.http,this.initiailzed=!1}function n(e,t,n){var o=0,i=[];for(t=t||0,n=n||e.length;n>t;)i[o++]=e[t++];return i}var o={},i={page:"page",offset:"offset",count:"count",callback:"callback"};e.addBeforeKeydownHandler(function(){return Object.keys(o).some(function(e){return o[e].isLoading()?!0:void 0})?!1:void 0},-1e3),t.prototype.isInitialized=function(){return this.initiailzed},t.prototype.isLoading=function(){return this.loading},t.prototype.getTotalCount=function(){return this.totalCount},t.prototype.getCurrentCount=function(){return this.items.length},t.prototype.getLoadingCount=function(){return this.loadingCount},t.prototype.setLoadingCount=function(e){return this.loadingCount||(this.loadingCount=e),this},t.prototype.getThresholdCount=function(){return this.thresholdCount},t.prototype.setThresholdCount=function(e){return this.thresholdCount||(this.thresholdCount=e),this},t.prototype.getOffset=function(){return this.offset},t.prototype.setOffset=function(e){return this.offset=e,this},t.prototype.setHttp=function(e){return this.http=e,this},t.prototype.initialize=function(e){this.initiailzed||this.loading||this.request(function(t,n,o){if(this.append(t),this.offset+=this.loadingCount,this.totalCount=this.onGetTotalCount(n,o),null==this.totalCount)throw Error('Check the "getTotalCount" callback function. It should return total item count as a number.');this.initiailzed=!0,(e||angular.noop)(t,this.totalCount,n,o,this)}.bind(this))},t.prototype.beforeRequest=function(){this.loading=!0,this.onBeforeLoad(this)},t.prototype.afterRequest=function(e,t){if(this.onAfterLoad(e,t,this),this.loading=!1,!this.initiailzed)throw Error("Fail to request. Please check the given url or connection.")},t.prototype.request=function(e){this.loading||(this.beforeRequest(),this.http({url:this.url,method:this.method,headers:this.headers,params:this.getParams()}).success(function(t,n){var o=this.onGetItems(t);o&&o.length>0&&(e||angular.noop)(o,t,n,this),this.afterRequest(t,n)}.bind(this)).error(function(e,t){this.afterRequest(e,t)}.bind(this)))},t.prototype.getParams=function(){var e={};return e[this.parameterNames.page]=Math.floor(this.offset/this.loadingCount)+1,e[this.parameterNames.offset]=this.offset,e[this.parameterNames.count]=this.loadingCount,e[this.parameterNames.callback]="JSON_CALLBACK",e},t.prototype.isNeededForPrevious=function(e){var t=this.offset-2*this.loadingCount;return t>0&&t+this.thresholdCount>e},t.prototype.isNeededForNext=function(e){var t=this.getCurrentCount();return this.getTotalCount()>t&&e>t-this.thresholdCount},t.prototype.get=function(e){if(!this.initiailzed)throw Error("Do not ready to use. Please use after initializing properly. Also verify whether the given url is available or not.");return this.items[e]},t.prototype.prepend=function(e){var t;this.offset>0&&(t=[],t.length=this.offset-2*this.loadingCount,this.items=t.concat(e).concat(n(this.items,this.offset-this.loadingCount,this.offset)))},t.prototype.append=function(e){var t,o;this.offset>this.loadingCount?(o=this.offset-this.loadingCount,t=[],t.length=o,this.items=t.concat(n(this.items,o)).concat(e)):this.items=this.items.concat(e)},this.register=function(e,n){if(o[e])throw Error("The given name "+e+" already has been registered.");return o[e]=new t(n||{}),this},this.unregister=function(e){return delete o[e],this},this.$get=["$http",function(e){return{get:function(t){var n=o[t];return n&&!n.isInitialized()&&n.setHttp(e),n}}}]}angular.module("caph.focus",[],["$provide","$compileProvider",function(e,t){function n(e){return e&&e+""}function o(e){var t=jQuery(e).data(),o={};return Object.keys(s.DIRECTION).forEach(function(e){var i=s.DIRECTION[e],r="focusableNextFocus"+u(i),a=t[r];(a||null===a)&&(o[i]=n(a))}),{depth:t.focusableDepth,group:n(t.focusableGroup),name:n(t.focusableName),initialFocus:t.focusableInitialFocus,disabled:t.focusableDisabled,nextFocus:o}}function i(e,t){return e=jQuery(e),e.data({focusableDepth:angular.isNumber(t.depth)?t.depth:s.DEFAULT.DEPTH,focusableGroup:t.group||s.DEFAULT.GROUP,focusableName:t.name||l.get(),focusableInitialFocus:t.initialFocus===!0,focusableDisabled:t.disabled===!0}),t.nextFocus&&Object.keys(t.nextFocus).forEach(function(n){var o="focusableNextFocus"+u(n),i=t.nextFocus[n];(i||null===i)&&e.data(o,i)}),e.data("focusableName")}function r(e){return e&&e instanceof jQuery?e[0]:e}function a(e){return e&&e.nodeType===Node.ELEMENT_NODE?!0:!1}function u(e){return e?e.charAt(0).toUpperCase()+e.substr(1):e}var s={DIRECTION:{LEFT:"left",RIGHT:"right",UP:"up",DOWN:"down"},DEFAULT:{DEPTH:0,GROUP:"default",KEY_MAP:{LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13},DISTANCE_CALCULATION_STRATEGY:"default"}},c=0,l={get:function(){return"focusable-"+c++}},d=".focusable",f={mouseover:"focus",mouseout:"blur",click:"select"},p=["focused","blurred","selected"],h={NameGenerator:l,isFocusable:function(e){return a(e=r(e))&&null!==e.getAttribute("focusable")},isElement:function(e){return a(r(e))},isVisible:function(e){if(a(e=r(e))){for(;e;){if("none"===jQuery.css(e,"display")||"hidden"===jQuery.css(e,"visibility"))return!1;e=e.parentElement}return!0}return!1},getElement:function(e){return a(e=r(e))?e:null},getData:function(e){return h.isFocusable(e)?o(r(e)):null},setData:function(e,t){return h.isFocusable(e)?i(e=r(e),t&&angular.extend(o(e),t)||o(e)):null},bindMouseEvent:function(e,t){return h.isElement(e)&&Object.keys(f).forEach(function(n){jQuery(e).on(n+d,{method:f[n]},t)}),this},bindFocusableEvent:function(e,t){return h.isElement(e)&&p.forEach(function(n){jQuery(e).on(n+d,t)}),this},unbindEvent:function(e){return h.isElement(e)&&jQuery(e).off(d),this}};e.constant("FocusConstant",s),e.constant("FocusUtil",h),e.provider({focusController:FocusControllerProvider,nearestFocusableFinder:NearestFocusableFinderProvider}),t.directive("focusable",focusableDirective)}]),FocusControllerProvider.$inject=["FocusConstant"];var focusableDirective=["$parse","$interpolate","$animate","FocusUtil","nearestFocusableFinder","focusController",function(e,t,n,o,i,r){function a(e,t){return angular.isString(e)&&0===e.indexOf(t)}function u(e,t){return angular.isString(e)&&e.indexOf(t)===e.length-t.length}function s(e,t){switch(t){case"focused":n.addClass(e,c);break;case"blurred":n.removeClass(e,c)}}var c="focused",l="disabled",d=[{focusableDepth:function(e){return 1*e}},{focusableGroup:angular.identity},{focusableName:angular.identity},{focusableInitialFocus:function(e){return"true"===e}},{focusableDisabled:function(e){return"true"===e}},{focusableNextFocusLeft:angular.identity},{focusableNextFocusRight:angular.identity},{focusableNextFocusUp:angular.identity},{focusableNextFocusDown:angular.identity}];return{restrict:"A",scope:!0,link:function(c,f,p){c.$applyAsync(function(e){var o=f.data();d.forEach(function(n){var i=Object.keys(n)[0],r=o[i];r&&a(r,t.startSymbol())&&u(r,t.endSymbol())&&f.data(i,n[i](t(r)(e)))}),i.$$put(f[0],e.$eval(p.focusable)),r.$$setInitialFocusItem(f[0]),o.focusableDisabled&&n.addClass(f,l)}),o.bindMouseEvent(f[0],function(e){var t=e.currentTarget||e.target;r.$$ignoreMouseEvent!==!0&&o.getData(t).depth===r.getCurrentDepth()&&r[e.data.method](t,e)}),o.bindFocusableEvent(f[0],function(t,n){c.$applyAsync(function(o){s(f,t.type),(e(p[p.$normalize("on-"+t.type)])||angular.noop)(o,{$event:t,$originalEvent:n})})}),c.$on("$destroy",function(){o.unbindEvent(i.$$remove(f[0])),f.remove()})}}}];NearestFocusableFinderProvider.$inject=["FocusConstant","focusControllerProvider"];var caphButtonDirective=["$parse","focusController","FocusUtil",function(e,t,n){return{restrict:"E",transclude:!0,template:'<div class="{{buttonClass}}" focusable ng-transclude on-focused="focus($event, $originalEvent)" on-selected="select($event, $originalEvent)" on-blurred="blur($event, $originalEvent)"></div>',scope:!0,link:function(t,o,i){var r=!1,a=o.find("div"),u=t.$eval(i.toggle)||{};t.buttonClass=i.buttonClass||"caph-button";var s=t.$eval(i.focusOption);i.$observe("buttonClass",function(e){t.buttonClass=e}),s&&n.setData(a,s),t.focus=function(n,o){(e(i.onFocused)||angular.noop)(t.$parent,{$event:n,$originalEvent:o})},t.blur=function(n,o){(e(i.onBlurred)||angular.noop)(t.$parent,{$event:n,$originalEvent:o})},t.select=function(n,o){u?(r=!r,(e(i.onSelected)||angular.noop)(t.$parent,{$event:n,$selected:r,$originalEvent:o}),a.toggleClass("selected")):(e(i.onSelected)||angular.noop)(t.$parent,{$event:n,$originalEvent:o})}}}}],caphCheckboxDirective=["$parse","focusController","FocusUtil",function(e,t,n){return{restrict:"E",transclude:!0,template:'<div class="{{checkboxClass}}"focusable ng-transclude on-focused="focus($event, $originalEvent)" on-selected="select($event, $originalEvent)" on-blurred="blur($event, $originalEvent)" ng-class="{checked : checked}">{{check}}</div>',scope:!0,link:function(t,o,i){t.checked=t.$eval(i.checked)||!1,t.checkboxClass=i.class||"caph-checkbox",i.$observe("checkboxClass",function(e){t.checkboxClass=e});var r=o.find("div"),a=t.$eval(i.focusOption);a&&n.setData(r,a),t.focus=function(n,o){(e(i.onFocused)||angular.noop)(t.$parent,{$event:n,$originalEvent:o})},t.blur=function(n,o){(e(i.onBlurred)||angular.noop)(t.$parent,{$event:n,$originalEvent:o})},t.select=function(n,o){t.checked=!t.checked,(e(i.onSelected)||angular.noop)(t.$parent,{$event:n,$checked:t.checked,$originalEvent:o})}}}}],caphTranscludeDirective=[function(){return{restrict:"A",link:function(e,t,n,o,i){var r=n.caphTransclude;i(function(e){if(r){var n="";for(var o in e)if(e[o].tagName&&r.toLowerCase()===e[o].tagName.toLowerCase()){n=e[o];break}t.empty(),t.append(n)}else t.empty(),t.append(e)})}}}],caphContextMenuItemTemplateDirective=["$sce","$compile",function(e,t){return{restrict:"E",require:["?^caphContextMenu"],tranclude:!0,link:function(n,o){n.$parent.$watch("item",function(t){for(var o in t)n[o]="content"===o?e.trustAsHtml(t[o]+""):t[o]},!0),o.replaceWith(t("<span>"+o.html()+"</span>")(n))}}}],caphContextMenuArrowUpTemplateDirective=function(){return{restrict:"E",require:["?^caphContextMenu"],tranclude:!0}},caphContextMenuArrowDownTemplateDirective=function(){return{restrict:"E",require:["?^caphContextMenu"],tranclude:!0}},caphContextMenuDirective=["$parse","focusController","FocusConstant","$timeout","$window",function(e,t,n,o,i){var r={FOCUSABLE_DEPTH:1e4},a={translateTo:function(e,t,n){e&&e.css("transform","translate3d("+t+"px,"+n+"px, 0)")},getSuitablePosition:function(e,t,n){var o=e.offset();for(var r in t)if(o.left+t[r].x>0&&o.left+t[r].x+e.outerWidth()<angular.element(i).width()&&(n||o.top+t[r].y>0&&o.top+t[r].y+e.outerHeight()<angular.element(i).height()))return t[r];return t.length>0?t[0]:void 0},getCalculatedOffset:function(e,t){var n=e.offset();return{x:t.x-n.left,y:t.y-n.top}}};return{restrict:"E",template:'<div class="caph-context-menu {{menuList[\'root\'].option.class}}" ng-class="{{menuList[\'root\'].option.class}}"><div class="arrow-up" ng-show="menuList[\'root\'].option.visibleItemCount > 0 && menuList[\'root\'].option.visibleItemCount < menuList[\'root\'].itemList.length" ng-click="onSelectUpButton($event)" caph-transclude="caph-context-menu-arrow-up-template"></div><ul ng-style="menuList[\'root\'].option.style" data-visible-item-count="{{menuList[\'root\'].option.visibleItemCount}}" data-scroll-count="0" data-submenu-id="root"><li ng-repeat="item in menuList[\'root\'].itemList" id="{{item.id}}" focusable data-focusable-depth="{{menuList[\'root\'].focusableDepth}}" data-focusable-initial-focus="{{$index===0}}" ng-class="{hasSubMenu:menuList[item.id], opened:(menuList[item.id] && menuList[item.id].show), disabled:item.disabled}"  data-focusable-disabled="{{item.disabled || checkItemExist(menuList[\'root\'].itemList, item)}}" on-selected="onSelectItem($event, (menuList[item.id])?item.id:false)" ng-click="onClickItem((menuList[item.id])?item.id:false)"  on-focused="focusItem($event, $originalEvent)" on-blurred="blurItem($event, $originalEvent)" caph-transclude="caph-context-menu-item-template"></li></ul><div class="arrow-down" ng-show="menuList[\'root\'].option.visibleItemCount > 0 && menuList[\'root\'].option.visibleItemCount < menuList[\'root\'].itemList.length" ng-click="onSelectDownButton($event)" caph-transclude="caph-context-menu-arrow-down-template"></div></div><div class="caph-context-menu {{submenu.option.class}}" ng-repeat="(menuId, submenu) in menuList" ng-if="menuId != \'root\'" ng-show="submenu.show" id="sub_{{menuId}}" data-submenu-id="{{menuId}}"><div class="arrow-up" ng-show="submenu.option.visibleItemCount > 0 && submenu.option.visibleItemCount < submenu.itemList.length" ng-click="onSelectUpButton($event)" caph-transclude="caph-context-menu-arrow-up-template"></div><ul ng-style="submenu.option.style" data-visible-item-count="{{submenu.option.visibleItemCount}}" data-scroll-count="0" data-submenu-id="{{menuId}}"><li ng-repeat="item in submenu.itemList" id="{{item.id}}" focusable data-focusable-depth="{{submenu.focusableDepth}}" data-focusable-initial-focus="{{$index===0}}"  data-focusable-disabled="{{item.disabled || checkItemExist(submenu.itemList, item)}}" on-selected="onSelectItem($event, (menuList[item.id])?item.id:false)" ng-click="onClickItem((menuList[item.id])?item.id:false)"  on-focused="focusItem($event, $originalEvent)" on-blurred="blurItem($event, $originalEvent)" data-previous-depth="{{subMenu.previousDepth}}" ng-class="{hasSubMenu:menuList[item.id], opened:(menuList[item.id] && menuList[item.id].show), disabled:item.disabled}" caph-transclude="caph-context-menu-item-template"></li></ul><div class="arrow-down" ng-show="submenu.option.visibleItemCount > 0 && submenu.option.visibleItemCount < submenu.itemList.length" ng-click="onSelectDownButton($event)" caph-transclude="caph-context-menu-arrow-down-template"></div></div>',transclude:!0,scope:!0,link:function(i,u,s){i.focusableDepth=angular.isNumber(1*s.focusableDepth)?1*s.focusableDepth:r.FOCUSABLE_DEPTH,i.show=!0,i.menuList={};var c,l=t.getCurrentDepth();i.checkItemExist=function(e,t){return 0>$.inArray(t,e)},i.onSelectItem=function(t,n){var o=angular.element(t.currentTarget);n?i.menuList[n].show?E(n):x(n,o):(e(s.onSelectItem)||angular.noop)(i.$parent,{$itemId:o.attr("id"),$event:t})},i.focusItem=function(t,n){(e(s.onFocusItem)||angular.noop)(i.$parent,{$event:t,$originalEvent:n})},i.blurItem=function(t,n){(e(s.onBlurItem)||angular.noop)(i.$parent,{$event:t,$originalEvent:n})},i.onClickItem=function(e){e&&(w[e]=o(function(){E(e),delete w[e]},700))},i.onSelectUpButton=function(e){var t=angular.element(e.currentTarget).next();y(t,"up",t.data("visibleItemCount"))},i.onSelectDownButton=function(e){var t=angular.element(e.currentTarget).prev();y(t,"down",t.data("visibleItemCount"))};var d=function(e){t.setDepth(angular.element(e.currentTarget).data("focusableDepth")),t.focus(e.currentTarget)},f=function(e){var t=angular.element(e.currentTarget).data("submenuId");t&&(w[t]=o(function(){E(t),delete w[t]},700))},p=function(e){var t=angular.element(e.currentTarget).data("submenuId"),n=i.menuList[t]?i.menuList[t].parentId:void 0;t&&w[t]&&(o.cancel(w[t]),delete w[t]),n&&w[n]&&(o.cancel(w[n]),delete w[n])},h=function(){T()},m=function(e){var t,o,i;if(e.event.keyCode===n.DEFAULT.KEY_MAP.LEFT){var r=angular.element(e.currentFocusItem).parent().data("submenuId");"root"===r?T():E(r)}else if(e.event.keyCode===n.DEFAULT.KEY_MAP.DOWN){if(t=angular.element(e.currentFocusItem).parent(),t.data("visibleItemCount")){o=t.find("li"),i=jQuery.inArray(e.currentFocusItem,o);var a=i-t.data("scrollCount")-t.data("visibleItemCount")+1;i-t.data("scrollCount")>=t.data("visibleItemCount")&&y(t,"down",t.data("visibleItemCount"),a)}}else e.event.keyCode===n.DEFAULT.KEY_MAP.UP&&(t=angular.element(e.currentFocusItem).parent(),t.data("visibleItemCount")&&(o=t.find("li"),i=jQuery.inArray(e.currentFocusItem,o),0>i-t.data("scrollCount")&&y(t,"up",t.data("visibleItemCount"),t.data("scrollCount")-i)))},g=function(){angular.element(document).off("click",h)},v=function(){angular.isNumber(l)&&(t.setDepth(l),angular.element(document).on("click",h))},b=function(e,t){var n={};for(var o in e){if(e[o].parent||(e[o].parent="root"),!e[o].id||!e[o].content)throw Error("Each data should have properties 'id' and 'content'");if(n[e[o].id])throw Error("Item's id is duplicated. (id = '"+e[o].id+"')");n[e[o].id]=e[o]}var i={},r=function(e,t){i[e]={focusableDepth:t+Object.keys(i).length,previousDepth:void 0,menuDepth:void 0,itemList:[],option:{},show:!1}};r("root",t);for(var a in e)i[e[a].parent]||r(e[a].parent,t),i[e[a].parent].itemList.push(e[a]);for(var u in i)if("root"===u)i[u].menuDepth=0;else{if(!n[u])throw Error("Parent item is not exist for the item (id = '"+u+"')");for(var s=u,c=1,l=i[n[s].parent].focusableDepth;n[s]&&"root"!==n[s].parent;)s=n[s].parent,c++;i[u].previousDepth=l,i[u].menuDepth=c,i[u].parentId=n[u].parent}return i},C=function(e){if(e)for(var t in i.menuList)e[i.menuList[t].menuDepth]&&(i.menuList[t].option=e[i.menuList[t].menuDepth])};i.$watch(s.items,function(e){i.menuList=b(e,i.focusableDepth),c=i.$eval(s.menuOption)||{},C(c)},!0),i.$watch(s.menuOption,function(e){c=e,C(c)},!0);var I;i.$watch(s.position,function(e){I=e;var t=u.find(".caph-context-menu:first-child");if(I&&angular.isNumber(I.x)&&angular.isNumber(I.y)){a.translateTo(t,0,0);var n=a.getCalculatedOffset(t,I);a.translateTo(t,n.x,n.y)}});var D=u.offset(),w={},x=function(e,n){i.menuList[e].show=!0;var o=angular.element(n).offset(),r=i.menuList[e].option.offset||{x:0,y:0},u=angular.element("#sub_"+e);u.removeClass("ng-hide");var s=a.getSuitablePosition(u,[{x:angular.element(n).outerWidth()+o.left-D.left+r.x,y:o.top-D.top+r.y},{x:o.left-D.left-u.outerWidth()-r.x,y:o.top-D.top+r.y}],!0);a.translateTo(u,s.x,s.y),t.setDepth(i.menuList[e].focusableDepth);var c=angular.element("#sub_"+e+">ul>li");i.menuList[e].option.visibleItemCount=Math.min(c.length,i.menuList[e].option.visibleItemCount),i.menuList[e].option.visibleItemCount&&(i.menuList[e].option.style.height=c.eq(0).outerHeight()*i.menuList[e].option.visibleItemCount,i.menuList[e].option.style.overflow="hidden")},E=function(e){if(e){i.menuList[e].show=!1;for(var n in i.menuList)i.menuList[n].parentId===e&&(i.menuList[n].show=!1);t.setDepth(i.menuList[e].previousDepth)}else{for(var r in i.menuList)i.menuList[r].show=!1,w[r]&&(o.cancel(w[r]),delete w[r]);t.setDepth(i.menuList.root.focusableDepth)}},y=function(e,t,n,o){var i=e.find("li");o=Math.abs(o)||1,"up"===t&&e.data("scrollCount")>0?e.data("scrollCount",e.data("scrollCount")-o):"down"===t&&e.data("scrollCount")<i.length-n&&e.data("scrollCount",e.data("scrollCount")+o),a.translateTo(i,0,-1*e.data("scrollCount")*i.eq(0).outerHeight())};i.$watch(s.show,function(e){e===!0?L():T()});var L=function(){if(!i.$eval(s.show)){var n=e(s.show);n.assign(i,!0),i.$applyAsync()}u.removeClass("ng-hide");var o=u.find(".caph-context-menu:first-child");if(I&&angular.isNumber(I.x)&&angular.isNumber(I.y)){a.translateTo(o,0,0);var r=a.getCalculatedOffset(o,I);a.translateTo(o,r.x,r.y)}var c=o.find(">ul>li");i.menuList.root.option.visibleItemCount=Math.min(c.length,i.menuList.root.option.visibleItemCount),i.menuList.root.option.visibleItemCount&&(i.menuList.root.option.style.height=c.eq(0).outerHeight()*i.menuList.root.option.visibleItemCount,i.menuList.root.option.style.overflow="hidden"),angular.isNumber(i.focusableDepth)&&t.setDepth(i.focusableDepth),t.addAfterKeydownHandler(m),angular.element(document).on("click",h);var l=u.find("div.caph-context-menu");l.on("mouseover",p).on("mouseleave",f),l.find("> ul > li").on("mouseover",d),u.on("mouseover",g).on("mouseleave",v),i.$applyAsync()},T=function(){u.addClass("ng-hide"),E(),angular.isNumber(l)&&t.setDepth(l),t.removeAfterKeydownHandler(m),angular.element(document).off("click",h);var n=u.find("div.caph-context-menu");if(n.off("mouseover",p).off("mouseleave",f),n.find("> ul > li").off("mouseover",d),u.off("mouseover",g).off("mouseleave",v),i.$eval(s.show)){var o=e(s.show);o.assign(i,!1),i.$applyAsync()}}}}}],caphDialogTitleDirective=function(){return{restrict:"E",require:"?^caphDialog",template:'<div class="title-area"><div class="title-wrapper"><div class="title" ng-transclude></div></div></div>',transclude:!0}},caphDialogContentDirective=function(){return{restrict:"E",require:"?^caphDialog",transclude:!0,template:'<div class="content-area"><div class="content" ng-transclude></div></div>'}},caphDialogButtonsDirective=["DialogUtil","$parse",function(e,t){return{restrict:"E",require:"^caphDialog",scope:!0,template:'<div class="caph-dialog-button-area"><div class="button-wrapper" ng-if="btnTypeConfirm"><div class="caph-dialog-button" on-selected="onSelectButton(0, $event)" focusable="{depth: {{focusOption.depth}}, initialFocus: true}" data-focusable-group="{{focusOption.group}}" on-focused="focus($event)" on-blurred="blur($event)"><div class="button-text">Yes</div></div><div class="caph-dialog-button" on-selected="onSelectButton(1, $event)" focusable="{depth: {{focusOption.depth}}}" on-focused="focus($event)" data-focusable-group="{{focusOption.group}}" on-blurred="blur($event)"><div class="button-text">No</div></div></div><div class="button-wrapper" ng-if="btnTypeAlert"><div class="caph-dialog-button" on-selected="onSelectButton(0, $event)" focusable="{depth: {{focusOption.depth}}, initialFocus: true}" data-focusable-group="{{focusOption.group}}" on-focused="focus($event)" on-blurred="blur($event)"><div class="button-text">OK</div></div></div></div>',link:function(e,n,o,i){var r=o.buttonType;r&&"confirm"===r?e.btnTypeConfirm=!0:r&&"alert"===r&&(e.btnTypeAlert=!0),e.focusOption=i.getFocusOption(),e.onSelectButton=function(n,i){(t(o.onSelectButton)||angular.noop)(e.$parent,{$buttonIndex:n,$event:i})}}}}],caphDialogDirective=["dialogManager","$parse","DialogUtil","DialogConstant","focusController","$timeout",function(e,t,n,o,i,r){return{restrict:"E",template:'<div class="caph-dialog" ng-transclude></div>',transclude:!0,scope:!1,controller:["$scope","$element","$attrs",function(e,t,n){var i=e.$eval(n.focusOption)||{depth:o.DEFAULT.focusableDepth};i.group=i.group||"default",this.getFocusOption=function(){return i}}],link:function(a,u,s){var c={};c.timeout=a.$eval(s.timeout),c.center=a.$eval(s.center),c.position=a.$eval(s.position),c.focusOption=a.$eval(s.focusOption)||{depth:o.DEFAULT.focusableDepth},c.focusOption.group=c.focusOption.group||"default",c.modal=!0;var l,d=e.generateDialogId();e.addDialog(d,u,c);var f=i.getCurrentDepth(),p=u.find("> :first-child"),h=function(){if(!a.$eval(s.show)){var o=t(s.show);o.assign(a,!0)}c.center===!0?n.moveToCenter(p):c.position&&n.translateTo(p,c.position.x,c.position.y),i.setDepth(c.focusOption.depth,c.focusOption.group),e.manageModal(d,!0),(t(s.onOpen)||angular.noop)(a),l&&(r.cancel(l),l=null),angular.isNumber(c.timeout)&&(l=r(function(){u.addClass("ng-hide"),m(),l=null},c.timeout))},m=function(){if(a.$eval(s.show)){var n=t(s.show);n.assign(a,!1)}l&&(r.cancel(l),l=null),angular.isNumber(f)&&i.setDepth(f),e.manageModal(d,!1),(t(s.onClose)||angular.noop)(a)};a.$watch(s.center,function(e,t){e&&t&&e===!0&&n.moveToCenter(p)}),a.$watch(s.position,function(e,t){e&&t&&e&&n.translateTo(p,e.x,e.y)}),u.addClass("caph-dialog"),a.$watch(s.show,function(e){e===!0?(u.removeClass("ng-hide"),h()):e===!1&&(u.addClass("ng-hide"),m())})}}}],dialogManagerProvider=function(){var e,t={},n=0,o={generateDialogId:function(){return n++ +"_"+(new Date).getTime()},addDialog:function(e,n,o){if(this.getDialog(e))throw Error("Dialog ID ("+e+") is already registered.");t[e]={element:n,option:o,isOpened:!1}},getDialog:function(e){return t[e]},createDim:function(){e||(e=document.createElement("div"),e.classList.add("caph-dim-init"),document.getElementsByTagName("body")[0].appendChild(e))},activateDim:function(){e||this.createDim(),e.classList.add("caph-dim-translucent")},deactivateDim:function(){e&&e.classList.remove("caph-dim-translucent")},manageModal:function(e,n){var i=this.getDialog(e);if(!i)throw Error("Dialog ("+e+") is not registered. Is this id correct?");if(i.isOpened=n,i.option.modal){n?o.activateDim():o.deactivateDim();for(var r in t)r!==e&&t[r].option.modal&&t[r].isOpened&&(t[r].element.addClass("ng-hide"),t[r].isOpened=!1)}}};return{$get:function(){return{generateDialogId:o.generateDialogId,addDialog:o.addDialog,getDialog:o.getDialog,manageModal:o.manageModal}}}},caphDropdownListItemTemplateDirective=["$sce","$compile",function(e,t){return{restrict:"E",require:["?^caphDropdownList"],tranclude:!0,link:function(n,o){n.$parent.$watch("item",function(t){for(var o in t)n[o]="content"===o?e.trustAsHtml(t[o]+""):t[o]
},!0),o.replaceWith(t("<span>"+o.html()+"</span>")(n))}}}],caphDropdownListPlaceholderTemplateDirective=["$compile",function(e){return{restrict:"E",require:"?^caphDropdownList",tranclude:!0,link:function(t,n){n.replaceWith(e("<span>"+n.html()+"</span>")(t))}}}],caphDropdownArrowUpTemplateDirective=[function(){return{restrict:"E",require:"?^caphDropdownList",tranclude:!0}}],caphDropdownArrowDownTemplateDirective=[function(){return{restrict:"E",require:"?^caphDropdownList",tranclude:!0}}],caphDropdownListDirective=["$parse","focusController","FocusConstant","FocusUtil","$timeout",function(e,t,n,o,i){var r={FOCUSABLE_DEPTH:2e4},a={translateTo:function(e,t,n){e&&e.css("transform","translate3d("+t+"px,"+n+"px, 0)")}};return{restrict:"E",template:'<div class="caph-dropdown-list"><div class="placeholder" ng-class="{focused: focused, selected: showList}" focusable="focusForPlaceholder" caph-transclude="caph-dropdown-list-placeholder-template"></div><div class="list-container" ng-show="showList"><div class="textbox arrow-up" ng-show="showArrowUp" ng-click="onSelectUpButton($event)"><div class="label center" caph-transclude="caph-dropdown-list-arrow-up-template"></div></div><div class="list-items" ng-style="listContainerStyle" data-scroll-count="0" data-visible-item-count="{{visibleItemCount}}"><div class="textbox" ng-repeat="item in items" focusable="focusForList" data-disabled="{{item.disabled}}" on-selected="onSelectItem($event, item.id)"><div class="label" caph-transclude="caph-dropdown-list-item-template"></div></div></div><div class="textbox arrow-down" ng-show="showArrowDown" ng-click="onSelectDownButton($event)"><div class="label center" caph-transclude="caph-dropdown-list-arrow-down-template"></div></div></div></div>',transclude:!0,scope:!0,link:function(o,u,s){o.visibleItemCount=o.$eval(s.visibleItemCount)||0,o.focusForPlaceholder=o.$eval(s.focusOption)||{depth:t.getCurrentDepth()},o.focusForList={depth:o.focusForPlaceholder.depth+r.FOCUSABLE_DEPTH||r.FOCUSABLE_DEPTH,group:o.focusForPlaceholder.group,disabled:!0},o.showList=o.focused=o.selected=o.disabled=!1;var c=u.find(".placeholder"),l=u.find(".list-container"),d=function(){o.$applyAsync(function(e){e.showList=!0}),o.visibleItemCount>0&&o.visibleItemCount<o.items.length&&(o.listContainerStyle={height:o.visibleItemCount*u.find(".list-items>.textbox").outerHeight(),overflow:"hidden"},o.showArrowUp=u.find("caph-dropdown-list-arrow-up-template").length>0,o.showArrowDown=u.find("caph-dropdown-list-arrow-down-template").length>0),t.addBeforeKeydownHandler(h),t.addAfterKeydownHandler(m),l.on("mouseover",v).on("mouseleave",b),i(function(){u.find(".list-items>.textbox").each(function(){angular.element(this).data("disabled")!==!0&&t.enable(this)}),t.setDepth(o.focusForList.depth),angular.element(document).on("click",g)},0)},f=function(){u.find(".list-items>.textbox").each(function(){t.disable(this)}),o.showList=!1,t.setDepth(o.focusForPlaceholder.depth),t.removeBeforeKeydownHandler(h),t.removeAfterKeydownHandler(m),l.off("mouseover",v).off("mouseleave",b),angular.element(document).off("click",g)},p=function(e,t,n,o){var i=e.find(".textbox");o=Math.abs(o)||1,"up"===t&&e.data("scrollCount")>0?e.data("scrollCount",e.data("scrollCount")-o):"down"===t&&e.data("scrollCount")<i.length-n&&e.data("scrollCount",e.data("scrollCount")+o),a.translateTo(i,0,-1*e.data("scrollCount")*i.eq(0).outerHeight())};o.$watch(s.items,function(e){o.items=e},!0);var h=function(e){return e.event.keyCode===n.DEFAULT.KEY_MAP.LEFT||e.event.keyCode===n.DEFAULT.KEY_MAP.RIGHT?(f(),!1):void 0},m=function(e){var t,o,i;if(e.event.keyCode===n.DEFAULT.KEY_MAP.DOWN){if(t=angular.element(e.currentFocusItem).parent(),t.data("visibleItemCount")){o=t.find(".textbox"),i=jQuery.inArray(e.currentFocusItem,o);var r=i-t.data("scrollCount")-t.data("visibleItemCount")+1;i-t.data("scrollCount")>=t.data("visibleItemCount")&&p(t,"down",t.data("visibleItemCount"),r)}}else e.event.keyCode===n.DEFAULT.KEY_MAP.UP&&(t=angular.element(e.currentFocusItem).parent(),t.data("visibleItemCount")&&(o=t.find(".textbox"),i=jQuery.inArray(e.currentFocusItem,o),0>i-t.data("scrollCount")&&p(t,"up",t.data("visibleItemCount"),t.data("scrollCount")-i)))},g=function(){f()},v=function(){angular.element(document).off("click",g)},b=function(){angular.element(document).on("click",g)};o.onSelectItem=function(t,n){(e(s.onSelectItem)||angular.noop)(o.$parent,{$itemId:n,$event:t}),f()},o.onSelectUpButton=function(e){var t=angular.element(e.currentTarget).next();p(t,"up",t.data("visibleItemCount"))},o.onSelectDownButton=function(e){var t=angular.element(e.currentTarget).prev();p(t,"down",t.data("visibleItemCount"))},c.on("focused",function(){o.focused=!0}),c.on("blurred",function(){o.focused=!1}),c.on("selected",function(){o.showList?f():d()})}}}],caphInputDirective=["$parse","focusController","FocusConstant","FocusUtil",function(e,t,n,o){return{restrict:"E",transclude:!0,template:'<input type="{{inputType}}" placeholder={{placeHolder}} value={{inputValue}} maxLength={{maxLength}} class="{{inputClass}}" focusable on-focused="focus($event, $originalEvent)" on-selected="select($event, $originalEvent)" on-blurred="blur($event, $originalEvent)">',scope:!0,link:function(i,r,a){i.inputClass=a.inputClass||"caph-input",i.inputType=a.type||"text",i.maxLength=i.$eval(a.maxLength)||40,i.placeHolder=a.placeHolder||"",a.$observe("inputClass",function(e){i.inputClass=e}),i.$watch("inputValue",function(){e(a.value).assign(i.$parent,i.inputValue)}),i.$parent.$watch(a.value,function(){i.inputValue=i.$eval(a.value)}),t.addBeforeKeydownHandler(function(e){var t=u[0],o=e.currentFocusItem;if(t===o){var i=t.selectionStart,r=t.value.length,a=e.event.keyCode;return a===n.DEFAULT.KEY_MAP.RIGHT&&r>i||a===n.DEFAULT.KEY_MAP.LEFT&&i>0?!1:void 0}});var u=r.find("> input"),s=i.$eval(a.focusOption);s&&o.setData(u,s),i.focus=function(t,n){(e(a.onFocused)||angular.noop)(i.$parent,{$event:t,$originalEvent:n}),n&&"keydown"===n.type&&u.focus()},i.blur=function(t,n){(e(a.onBlurred)||angular.noop)(i.$parent,{$event:t,$originalEvent:n}),n&&"keydown"===n.type&&u.blur()},i.select=function(t,n){u.blur(),u.focus(),(e(a.onSelected)||angular.noop)(i.$parent,{$event:t,$originalEvent:n})},u.on("change",function(t){i.$applyAsync(function(n){var o=t.target.value;n.inputValue=o,(e(a.onChanged)||angular.noop)(i.$parent,{$event:t,value:i.inputValue})})})}}}],caphListDirective=["$parse","$document","$window","$timeout","$interval","VendorUtil","FocusConstant","FocusUtil","focusController","listItemLoader",function(e,t,n,o,i,r,a,u,s,c){function l(e){return e>0&&1/0!==e}var d=".caph-list",f={ROW_COUNT:1,COLUMN_COUNT:1,DIRECTION:"horizontal",CONTAINER_CLASS:"caph-list-container",WRAPPER_CLASS:"caph-list-wrapper",DURATION:"0.5s",EASE:"ease-out",LOOP:!1,DELAY:100,MOUSE_SCROLL_AREA_SIZE:20,PAGE_BUFFER_SIZE:1,KEY:"item"},p=[{name:"containerClass",defaultValue:f.CONTAINER_CLASS},{name:"wrapperClass",defaultValue:f.WRAPPER_CLASS},{name:"initialized",defaultValue:!1}],h=s.getKeyMap();return{restrict:"E",transclude:!0,scope:!0,template:'<div class="{{containerClass}}" ng-show="initialized"><div class="{{wrapperClass}}" style="position: absolute"></div></div>',compile:function(a,m){function g(e,t){var n,o,i,r,a=L.width,u=L.height,s=T.width,c=T.height,d=u/c,f=a/s;if(!l(d)||!l(f))throw Error("The caph-list's container and template view should have their own size such as width and height.");if(n=Math.floor(d),o=Math.floor(f),1>n||1>o)throw Error("Please check the container and template view size. The calculated row or column count is less than 1.");i=Math.ceil(d),r=Math.ceil(f);var p={getMaxItemViewCount:function(){return this.getItemViewCountPerPage()*(2*t+1)},getMaxPageIndex:function(e){return Math.floor((e-1)/this.getItemViewCountPerPage())},getPageIndex:function(e){return Math.floor(e/this.getItemViewCountPerPage())},getStartItemIndex:function(e){return(e-t)*this.getItemViewCountPerPage()},getNextStartItemIndex:function(e){return(e+t+1)*this.getItemViewCountPerPage()},getPosition:function(e){var t=this.getRowIndex(e),n=this.getColumnIndex(e);return{top:t*c,left:n*s,rowIndex:t,columnIndex:n}},getNextPosition:function(e,t){var n=this.getPosition(e);switch(t){case h.LEFT:n.left-=s,n.columnIndex--;break;case h.RIGHT:n.left+=s,n.columnIndex++;break;case h.UP:n.top-=c,n.rowIndex--;break;case h.DOWN:n.top+=c,n.rowIndex++}return n}};return{horizontal:angular.extend({},p,{getItemViewCountPerPage:function(){return n*(o+1)},getRowIndex:function(e){return e%n},getColumnIndex:function(e){return Math.floor(e/n)},getTranslate:function(e,t){return"translate3d("+t*-s+"px, 0px, 0px)"},getScrollIndex:function(e,t){return Math.max(0,this.getColumnIndex(e)-t)},isVisibleItem:function(e,t,n){return t>=n&&n+r>t},getMouseScrollKeyCode:function(t){var n=t-y.left;return e>n?h.LEFT:n>a-e?h.RIGHT:0},isScrollDirection:function(e){switch(e){case h.LEFT:case h.RIGHT:return!0}return!1},getRotateItemIndex:function(e,t,o){return t>0?e:Math.min(o-1,this.getMaxColumnIndex(o)*n+e)},getMaxRowIndex:function(){return n-1},getMaxColumnIndex:function(e){return Math.floor((e-1)/n)},getScrollStartCount:function(){return o},getInitialScrollCount:function(e){return Math.min(this.getScrollStartCount(),this.getColumnIndex(e))},isPreviousDirection:function(e){return e===h.LEFT},isNextDirection:function(e){return e===h.RIGHT},getScrollCountVariation:function(e,t){return this.getColumnIndex(t)-this.getColumnIndex(e)},isReachedStart:function(e){return 0===this.getColumnIndex(e)},isReachedEnd:function(e,t){return this.getColumnIndex(e)===this.getMaxColumnIndex(t)}}),vertical:angular.extend({},p,{getItemViewCountPerPage:function(){return(n+1)*o},getRowIndex:function(e){return Math.floor(e/o)},getColumnIndex:function(e){return e%o},getTranslate:function(e,t){return"translate3d(0px, "+t*-c+"px, 0px)"},getScrollIndex:function(e,t){return Math.max(0,this.getRowIndex(e)-t)},isVisibleItem:function(e,t,n){return e>=n&&n+i>e},getMouseScrollKeyCode:function(t,n){var o=n-y.top;return e>o?h.UP:o>u-e?h.DOWN:0},isScrollDirection:function(e){switch(e){case h.UP:case h.DOWN:return!0}return!1},getRotateItemIndex:function(e,t,n){return e>0?t:Math.min(n-1,this.getMaxRowIndex(n)*o+t)},getMaxRowIndex:function(e){return Math.floor((e-1)/o)},getMaxColumnIndex:function(){return o-1},getScrollStartCount:function(){return n},getInitialScrollCount:function(e){return Math.min(this.getScrollStartCount(),this.getRowIndex(e))},isPreviousDirection:function(e){return e===h.UP},isNextDirection:function(e){return e===h.DOWN},getScrollCountVariation:function(e,t){return this.getRowIndex(t)-this.getRowIndex(e)},isReachedStart:function(e){return 0===this.getRowIndex(e)},isReachedEnd:function(e,t){return this.getRowIndex(e)===this.getMaxRowIndex(t)}})}}function v(e,t,n){function o(e,t){var o;w.append(e.addClass("ng-hide")),o=e.filter(function(){return this.nodeType===Node.ELEMENT_NODE}).on("focused"+d,n),t.$on("$destroy",function(){o.off(d)}),r.push({element:o,scope:t})}var i,r=[];for(i=0;t>i;i++)e(o);return r}var b,C,I,D,w,$,x,E,y,L,T,F=m.items,A=m.itemLoader,P=f.KEY;if(F&&A)throw Error('The "items" and "item-loader" option cannot be used together.');if(F){if(C=F.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)\s*$/),!C)throw Error('Expected expression in form of "_item_ in _array_" but got "'+F+'".');P=C[1],I=C[2]}return D=a.find("> :first-child"),w=D.find("> :first-child"),$=m.direction||f.DIRECTION,x=m.duration||f.DURATION,E=m.ease||f.EASE,function(a,l,m,C,F){function O(){$t=b.getItemViewCountPerPage(),xt=b.getMaxItemViewCount(),Ht=b.getScrollStartCount()}function S(e){Et=e,yt=e.length}function N(){return{width:D.width(),height:D.height()}}function R(){var e,t;return F(function(t,n){e={element:t,scope:n},ut(e),w.append(e.element)}),t=w.find("> :first-child"),a.$applyAsync(function(){e.scope.$destroy(),e.element.remove()}),{width:t.outerWidth(!0),height:t.outerHeight(!0)}}function M(e){yt>Kt&&(y=l.offset(),At=b.getMaxPageIndex(yt),Bt=b.getInitialScrollCount(Kt),wt=v(F,xt,function(e,t){var n,o,i,r;t&&(n=t.type,o=jQuery(e.currentTarget).data(),i=o.listItemIndex,Kt!==i&&("mouseover"===n||"keydown"===n)&&(r=b.getPageIndex(i),gt(i),dt(Ft,r),W(i,o.listItemRowIndex,o.listItemColumnIndex,r),"keydown"===n&&j(i)),it(i))}),W(Kt),H(b.getStartItemIndex(Ft),b.getNextStartItemIndex(Ft),e),j(Kt),a.initialized=!0)}function k(){return(xt+(_t-1))%xt}function U(){return(_t+1)%xt}function H(e,t,n){for(var o;t>e&&(o=wt[_t],V(o,P,Vt.get(e),e++,Vt.getTotalCount()),_t=U(),(n||angular.noop)(o)!==!1););}function B(e,t,n){for(var o;e>t;)if(_t=k(),o=wt[_t],(n||angular.noop)(o,e--)===!1){_t=U();break}}function _(e,t,n){B(e,t,function(e,t){return V(e,P,Vt.get(t),t,Vt.getTotalCount()),(n||angular.noop)(e)})}function V(e,t,n,o,i){n=o>-1&&i>o?n:null,K(e.scope,t,n,o,i),G(e.element,o,b.getPosition(o),n),n&&ut(e)}function K(e,t,n,o,i){e[t]=n||{},e.$index=o,e.$first=0===o,e.$last=o===i-1,e.$odd=!(e.$even=0===(1&o))}function G(e,t,n,o){e.css({position:"absolute",transform:"translate3d("+n.left+"px, "+n.top+"px, 0px)"}).data({listItem:!0,listItemIndex:t,listItemRowIndex:n.rowIndex,listItemColumnIndex:n.columnIndex,isVisibleListItem:function(e,t){return b.isVisibleItem(e,t,Ut)}}),o?e.removeClass("ng-hide"):e.addClass("ng-hide")}function j(e){var t;0===Bt?Ut=b.getScrollIndex(e,Bt):Bt===Ht&&(Ut=b.getScrollIndex(e,Bt-1)),Dt||(Dt=b.getTranslate(e,Ut)),t=b.getTranslate(e,Ut),t!==Dt&&(w.css("transform",t),Dt=t,Rt||(Rt=!0,at("on-scroll-start")))}function W(e,t,n,o){Kt=e,Lt=t||b.getRowIndex(e),Tt=n||b.getColumnIndex(e),Ft=o||b.getPageIndex(e)}function z(e){var t,n=-1;At=b.getMaxPageIndex(yt),S(e),Ft>=At-1&&(t=b.getNextStartItemIndex(Ft),B(t-1,-1,function(e,t){return e.element.hasClass("ng-hide")?C:(n=t,!1)}),H(n+1,t))}function q(e){var t,n,o,i=!1;S(e),t=yt-1,At=b.getMaxPageIndex(yt),Ft>At?(H(b.getStartItemIndex(At),b.getNextStartItemIndex(At),function(e){var t;n||(t=e.element,t.data().listItemIndex+1===yt&&(n=t))}),gt(t),W(t),j(t),Y(s.getCurrentFocusItem())&&s.focus(n)):Ft>=At-1&&(o=b.getNextStartItemIndex(Ft),B(o-1,-1,function(e,o){var r=e.element;return r.hasClass("focused")&&(i=!0,o!==t&&s.blur(r)),o===t?(n=r,!1):C}),H(t+1,o),Kt>t?(gt(t),W(t),j(t),i&&s.focus(n),it(t)):b.isReachedEnd(Kt,yt)&&at("on-reach-end"))}function Q(){var e=Y(s.getCurrentFocusItem());e&&s.blur(),pt(),M(function(t){var n=t.element;e&&Kt===n.data().listItemIndex&&o(function(){s.focus(n)})})}function Y(e){return e?(e=jQuery(e),e.data().listItem&&w[0]===e.parent()[0]):!1}function Z(){return Mt}function J(){Mt=!0,nt()}function X(){Ct=o(function(){Mt=!1},kt)}function et(){return It}function tt(e){et()||(It=i(function(){var t=Kt;Z()||Vt.isLoading()||(vt(),ot(b.getNextPosition(Kt,e),!0),t!==Kt&&rt(Kt))},kt))}function nt(){et()&&(i.cancel(It),It=null)}function ot(e,t){var n=lt(e);if(n){if(n.index===Kt)return!1;if(W(n.index,n.rowIndex,n.columnIndex,n.pageIndex),j(n.index),Vt.isNeededForPrevious(Kt)?(Vt.setOffset(Vt.getOffset()-3*Vt.getLoadingCount()),Vt.request(function(e){Vt.setOffset(Vt.getOffset()+2*Vt.getLoadingCount()),Vt.prepend(e)})):Vt.isNeededForNext(Kt)&&Vt.request(function(e){Vt.append(e),Vt.setOffset(Vt.getOffset()+Vt.getLoadingCount())}),(t||n.force)&&n.element)return s.focus(n.element),!1}else{if(Rt)return!1;St&&!t&&(pt(),Kt=b.getRotateItemIndex(Lt,Tt,yt),M(function(e){var t=e.element;Kt===t.data().listItemIndex&&o(function(){s.focus(t)})}))}}function it(e){at("on-focus-item-view"),rt(e)}function rt(e){b.isReachedStart(e)?at("on-reach-start"):b.isReachedEnd(e,yt)&&at("on-reach-end")}function at(t){a.$applyAsync(function(n){(e(m[m.$normalize(t)])||angular.noop)(n,{$context:{itemIndex:Kt,rowIndex:Lt,columnIndex:Tt,pageIndex:Ft,maxPageIndex:At,itemCount:yt,itemViewCountPerPage:$t}})})}function ut(t){(e(m[m.$normalize("on-decorate-item-view")])||angular.noop)(a,{$itemView:t})}function st(e){return 0>e||e>b.getMaxRowIndex(yt)}function ct(e){return 0>e||e>b.getMaxColumnIndex(yt)}function lt(e){var t,n,o,i,r,a,u,s,c=yt-1;return t=e.rowIndex,n=e.columnIndex,st(t)||ct(n)?s:(wt.forEach(function(e){o=e.element,u=o.data(),u.listItemIndex===c&&(a=o),t===u.listItemRowIndex&&n===u.listItemColumnIndex&&(o.hasClass("ng-hide")?(i=c,s={rowIndex:b.getRowIndex(i),columnIndex:b.getColumnIndex(i),force:!0}):(i=u.listItemIndex,s={rowIndex:t,columnIndex:n,element:o}),r=b.getPageIndex(i),dt(Ft,r),s.index=i,s.pageIndex=r)}),s.force&&(s.element=a),s)}function dt(e,t){var n;t>e?(n=(t+Nt)*$t,H(n,n+$t)):e>t&&(n=(t-Nt+1)*$t-1,_(n,n-$t))}function ft(){var e=N(),t=R();(L.width!==e.width||L.height!==e.height||T.width!==t.width||T.height!==t.height)&&a.$applyAsync(function(){J(),L=e,T=t,b=g(Ot,Nt)[$],O(),Q(),X()})}function pt(){wt.forEach(function(e){e.scope.$destroy(),e.element.remove()}),wt=null}function ht(e){t.trigger({type:"keydown",keyCode:e})}function mt(e){b.isPreviousDirection(e)&&Bt>0?Bt--:b.isNextDirection(e)&&Ht>Bt&&Bt++}function gt(e){Bt=Math.max(0,Math.min(Ht,Bt+b.getScrollCountVariation(Kt,e)))}function vt(){1===Bt?Bt=0:Bt===Ht-1&&(Bt=Ht)}function bt(e){var t,n=e.event.keyCode;if(Z()||Vt.isLoading())return!1;if(Y(e.currentFocusItem)&&b.isScrollDirection(n))return J(),mt(n),t=ot(b.getNextPosition(Kt,n)),X(),t;if(Rt){if(u.isVisible(w))return!1;Rt=!1,console.warn("The list is hidden before finishing scroll animation.")}}var Ct,It,Dt,wt,$t,xt,Et,yt,Lt,Tt,Ft,At,Pt=a.$eval(m.initialItemIndex)||0,Ot=a.$eval(m.mouseScrollAreaSize)||f.MOUSE_SCROLL_AREA_SIZE,St=a.$eval(m.loop)||f.LOOP,Nt=a.$eval(m.pageBufferSize)||f.PAGE_BUFFER_SIZE,Rt=!1,Mt=!1,kt=a.$eval(m.delay)||f.DELAY,Ut=0,Ht=0,Bt=0,_t=0,Vt={getTotalCount:function(){return yt},get:function(e){return Et[e]},isNeededForPrevious:angular.noop,isNeededForNext:angular.noop,isLoading:angular.noop,request:angular.noop,prepend:angular.noop,append:angular.noop},Kt=Pt;if(A&&St)throw Error('Cannot use continuous circular loop mode when using "item-loader".');s.addBeforeKeydownHandler(bt),p.forEach(function(e){a[e.name]=m[e.name]||e.defaultValue}),I&&a.$watchCollection(I,function(e){var t=e.length;J(),a.initialized?t>yt?z(e):yt>t&&q(e):t>0&&(S(e),L=N(),T=R(),b=g(Ot,Nt)[$],O(),M()),X()}),l.on("moveleft"+d,function(e){ht(h.LEFT),e.stopPropagation()}).on("moveright"+d,function(e){ht(h.RIGHT),e.stopPropagation()}).on("moveup"+d,function(e){ht(h.UP),e.stopPropagation()}).on("movedown"+d,function(e){ht(h.DOWN),e.stopPropagation()}).on("reload"+d,function(e){a.$applyAsync(function(){J(),Q(),X()}),e.stopPropagation()}).on("resize"+d,ft),D.on("mousemove"+d,function(e){var t=b.getMouseScrollKeyCode(e.clientX,e.clientY);0!==t?tt(t):nt()}).on("mouseout"+d,function(e){Y(e.relatedTarget)||(nt(),s.blur())}),w.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend",function(){Rt=!1,at("on-scroll-finish")}),jQuery(n).on("resize"+d,ft),o(function(){if(w.css("transition",[r.getVendorStyle("transform"),x,E].join(" ")),A){if(Vt=c.get(A),!Vt)throw Error("No such item loader: "+A);L=N(),T=R(),b=g(Ot,Nt)[$],O(),Vt.setLoadingCount(xt+$t),Vt.setThresholdCount($t*Nt+$t),Vt.initialize(function(e,t){J(),yt=t,M(),X()})}}),a.$on("$destroy",function(){Rt=!1,Mt=!1,pt(),D.off(d),l.off(d),jQuery(n).off(d),s.removeBeforeKeydownHandler(bt)})}}}}];ListItemLoaderProvider.$inject=["focusControllerProvider"];var caphRadioButtonDirective=["radiobuttonManager","$parse","focusController","FocusUtil",function(e,t,n,o){return{restrict:"E",transclude:!0,template:'<div ng-class="radiobuttonClass" focusable ng-transclude on-focused="focus($event, $originalEvent)" on-selected="select($event, $originalEvent)" on-blurred="blur($event, $originalEvent)"></div>',scope:!0,link:function(n,i,r){n.radiobuttonClass=r.radiobuttonclass||"caph-radiobutton";var a=n.$eval(r.focusOption),u=r.group||"default",s=i.find("> div");e.addRadio(s,u),void 0!==r.selected&&e.selectRadio(s,u),a&&o.setData(s,a),r.$observe("radiobuttonClass",function(e){n.radiobuttonClass=e}),n.focus=function(e,o){(t(r.onFocused)||angular.noop)(n.$parent,{$event:e,$originalEvent:o})},n.blur=function(e,o){(t(r.onBlurred)||angular.noop)(n.$parent,{$event:e,$originalEvent:o})},n.select=function(o,i){e.selectRadio(s,u),(t(r.onSelected)||angular.noop)(n.$parent,{$event:o,$originalEvent:i})}}}}],radiobuttonManagerProvider=function(){var e={},t={addRadio:function(t,n){e[n]=e[n]||[],e[n].push(t)},selectRadio:function(t,n){for(var o in e[n])void 0!==e[n][o].parent().attr("selected")&&(e[n][o].removeClass("selected"),e[n][o].parent().removeAttr("selected"));void 0===t.parent().attr("selected")&&t.parent().attr("selected",""),t.addClass("selected")}};return{$get:function(){return{addRadio:t.addRadio,selectRadio:t.selectRadio}}}};angular.module("caph.ui",["caph.focus"],["$provide","$compileProvider","nearestFocusableFinderProvider",function(e,t,n){function o(e){var t,n,o=e.charAt(0).toUpperCase()+e.substr(1);return null===a?(t=r.style,e in t?(a="",e):(i.some(function(e){return n=e+o,n in t?(a=e,!0):void 0}),r=null,n)):a?a+o:e}var i=["Webkit","Moz","O","ms"],r=document.createElement("div"),a=null,u={DEFAULT:{focusableDepth:9999}},s={translateTo:function(e,t,n){e&&e.css("transform","translate3d("+t+"px,"+n+"px, 0)")},moveToCenter:function(e){if(e){var t=window.innerWidth/2-e[0].clientWidth/2,n=window.innerHeight/2-e[0].clientHeight/2;0>n&&(n=0),0>t&&(t=0),t-=1*e[0].offsetLeft,this.translateTo(e,t,n)}}},c={getVendorProperty:o,getVendorStyle:function(e){var t=o(e);return t!==e?"-"+t.replace(/[A-Z]/g,function(e,t){var n=e.toLowerCase();return 0===t?n:"-"+n}):t}};["transform","transition"].forEach(function(e){var t=o(e);t!==e&&(jQuery.cssHooks[e]={get:function(e){return jQuery.css(e,t)},set:function(e,n){e.style[t]=n}})}),e.constant("DialogConstant",u),e.constant("DialogUtil",s),e.constant("VendorUtil",c),e.provider({dialogManager:dialogManagerProvider,radiobuttonManager:radiobuttonManagerProvider,listItemLoader:ListItemLoaderProvider}),t.directive({caphDialogTitle:caphDialogTitleDirective,caphDialogContent:caphDialogContentDirective,caphDialogButtons:caphDialogButtonsDirective,caphDialog:caphDialogDirective,caphList:caphListDirective,caphButton:caphButtonDirective,caphTransclude:caphTranscludeDirective,caphContextMenuItemTemplate:caphContextMenuItemTemplateDirective,caphContextMenuArrowUpTemplate:caphContextMenuArrowUpTemplateDirective,caphContextMenuArrowDownTemplate:caphContextMenuArrowDownTemplateDirective,caphContextMenu:caphContextMenuDirective,caphCheckbox:caphCheckboxDirective,caphRadiobutton:caphRadioButtonDirective,caphDropdownListItemTemplate:caphDropdownListItemTemplateDirective,caphDropdownListPlaceholderTemplate:caphDropdownListPlaceholderTemplateDirective,caphDropdownListArrowUpTemplate:caphDropdownArrowUpTemplateDirective,caphDropdownListArrowDownTemplate:caphDropdownArrowDownTemplateDirective,caphDropdownList:caphDropdownListDirective,caphInput:caphInputDirective}),n.addBeforeDistanceCalculationHandler(function(e){var t=jQuery(e).data()||{};return t.listItem!==!0||t.isVisibleListItem(t.listItemRowIndex,t.listItemColumnIndex)?void 0:!1})}]);